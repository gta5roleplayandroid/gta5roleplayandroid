<script>
function getDeviceId(){
  let id = localStorage.getItem("device_id");
  if(!id){
    id = crypto.randomUUID();
    localStorage.setItem("device_id", id);
  }
  return id;
}

async function go(){
  const token = document.getElementById("t").value.trim();
  const msg = document.getElementById("msg");

  if(!token){
    msg.innerText="‚ö†Ô∏è Token kosong";
    return;
  }

  msg.innerText="‚è≥ Mengecek token...";

  try{
    const res = await fetch(
      "https://tokengta5.lmore000013.workers.dev",
      {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({
          token: token,
          device: getDeviceId()
        })
      }
    );

    const data = await res.json();

    if(data.ok){
      document.body.innerHTML = `
        <iframe src="https://thinkmay.net"
        style="position:fixed;inset:0;width:100%;height:100%;border:0"></iframe>
      `;
    }else{
      const map = {
        TOKEN_EXPIRED: "‚è± Token sudah kadaluarsa",
        TOKEN_USED_DEVICE: "üì± Token sudah dipakai di device lain",
        TOKEN_INVALID: "‚ùå Token tidak valid"
      };
      msg.innerText = map[data.msg] || "‚ùå Token ditolak";
    }
  }catch(e){
    msg.innerText="‚ùå Server token error";
  }
}
</script>
