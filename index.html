<script>
function deviceId(){
  let d = localStorage.getItem("DEVICE_ID");
  if(!d){
    d = crypto.randomUUID();
    localStorage.setItem("DEVICE_ID", d);
  }
  return d;
}

function go(){
  const token = document.getElementById("t").value.trim();

  fetch("https://tokengta5.lmore000013.workers.dev/check",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      token: token,
      device: deviceId()
    })
  })
  .then(r=>r.json())
  .then(j=>{
    if(j.ok){
      localStorage.setItem("TOKEN_OK","1");
      document.getElementById("gate").remove();
      document.body.innerHTML +=
        `<iframe src="https://thinkmay.net"></iframe>`;
    }else{
      document.getElementById("msg").innerText =
        "❌ "+(j.error || "Token invalid");
    }
  })
  .catch(e=>{
    document.getElementById("msg").innerText="❌ SERVER ERROR";
  });
}

// AUTO LOGIN SAAT REFRESH
if(localStorage.getItem("TOKEN_OK")==="1"){
  document.getElementById("gate")?.remove();
  document.body.innerHTML +=
    `<iframe src="https://thinkmay.net"></iframe>`;
}
</script>
